{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "lcs.artifact.design.v1",
  "title": "LCS Design Artifact v1",
  "$defs": {
    "instructional_method": {
      "type": "string",
      "enum": [
        "direct-instruction",
        "worked-examples",
        "retrieval-practice",
        "problem-based-learning",
        "project-based-learning",
        "case-based-learning",
        "peer-instruction",
        "simulation-lab"
      ]
    }
  },
  "type": "object",
  "required": [
    "contract_version",
    "unit_id",
    "generated_at",
    "instructional_strategy",
    "pedagogy_decisions",
    "metadata"
  ],
  "properties": {
    "contract_version": {
      "type": "string",
      "pattern": "^1\\.0\\.0$"
    },
    "unit_id": {
      "type": "string",
      "pattern": "^[0-9]{3,}-[a-z0-9-]+$"
    },
    "generated_at": {
      "type": "string",
      "format": "date-time"
    },
    "instructional_strategy": {
      "type": "object",
      "required": [
        "primary_method",
        "secondary_methods",
        "rationale"
      ],
      "properties": {
        "primary_method": {"$ref": "#/$defs/instructional_method"},
        "secondary_methods": {
          "type": "array",
          "minItems": 0,
          "maxItems": 2,
          "uniqueItems": true,
          "items": {"$ref": "#/$defs/instructional_method"}
        },
        "rationale": {"type": "string", "minLength": 12}
      },
      "additionalProperties": false
    },
    "pedagogy_decisions": {
      "type": "object",
      "required": [
        "profile",
        "confidence_threshold",
        "confidence",
        "candidate_methods",
        "scores",
        "selection_rules",
        "research"
      ],
      "properties": {
        "profile": {"type": "string", "const": "corporate-lnd-v1"},
        "confidence_threshold": {"type": "number", "const": 0.7},
        "confidence": {"type": "number", "minimum": 0, "maximum": 1},
        "candidate_methods": {
          "type": "array",
          "minItems": 1,
          "maxItems": 12,
          "uniqueItems": true,
          "items": {"$ref": "#/$defs/instructional_method"}
        },
        "scores": {
          "type": "object",
          "required": [
            "learner_fit",
            "outcome_fit",
            "evidence_fit",
            "delivery_fit",
            "accessibility_fit"
          ],
          "properties": {
            "learner_fit": {"type": "number", "minimum": 0, "maximum": 5},
            "outcome_fit": {"type": "number", "minimum": 0, "maximum": 5},
            "evidence_fit": {"type": "number", "minimum": 0, "maximum": 5},
            "delivery_fit": {"type": "number", "minimum": 0, "maximum": 5},
            "accessibility_fit": {"type": "number", "minimum": 0, "maximum": 5}
          },
          "additionalProperties": false
        },
        "selection_rules": {
          "type": "object",
          "required": ["max_secondary_methods", "score_delta_threshold"],
          "properties": {
            "max_secondary_methods": {"type": "integer", "const": 2},
            "score_delta_threshold": {"type": "number", "const": 0.4}
          },
          "additionalProperties": false
        },
        "research": {
          "type": "object",
          "required": ["required", "triggers", "evidence_refs"],
          "properties": {
            "required": {"type": "boolean"},
            "triggers": {
              "type": "array",
              "uniqueItems": true,
              "items": {"type": "string", "minLength": 3}
            },
            "evidence_refs": {
              "type": "array",
              "uniqueItems": true,
              "items": {"type": "string", "minLength": 3}
            }
          },
          "allOf": [
            {
              "if": {
                "properties": {
                  "required": {"const": true}
                },
                "required": ["required"]
              },
              "then": {
                "properties": {
                  "triggers": {"minItems": 1},
                  "evidence_refs": {"minItems": 1}
                }
              }
            }
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "required": ["audience", "duration_minutes", "modality"],
      "properties": {
        "audience": {"type": "string", "minLength": 3},
        "duration_minutes": {"type": "integer", "minimum": 1},
        "modality": {
          "type": "string",
          "enum": ["self-paced", "instructor-led", "blended", "cohort-based", "virtual-led", "unspecified"]
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
